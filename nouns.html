<!DOCTYPE html>
<html lang=ru>
<head>
<meta charset=utf-8>
<meta name=viewport content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no'>
<title>Существительные</title>
<style>
th {
	font-size: 2rem;
}
td :link,
td :visited {
	color: black;
	text-decoration: none;
}
td :link:hover {
	text-decoration: underline;
}
.ending {
	color: green;
}
</style>
</head>
<body>
<h1>Существительные, изменения по родам и числам</h1>
<div id=controls-container></div>
<div id=table-container></div>
<script>
let articlesSetting=false
rewriteControls(document.getElementById('controls-container'))
rewriteTable(document.getElementById('table-container'))

function rewriteControls($container) {
	$container.innerHTML=''
	const $label=document.createElement('label')
	const $checkbox=document.createElement('input')
	$checkbox.type='checkbox'
	$checkbox.addEventListener('input',()=>{
		articlesSetting=$checkbox.checked
		rewriteTable(document.getElementById('table-container'))
	})
	$label.append($checkbox,` артикли`)
	$container.append($label)
}

function rewriteTable($container) {
	$container.innerHTML=''
	const $table=document.createElement('table')
	writeHeader($table)
	writeUsual($table)
	$container.append($table)
}

function writeHeader($table) {
	const $row=$table.insertRow()
	writeNumberCols(`♂`,`мужской род`)
	$row.insertCell()
	writeNumberCols(`♀`,`женский род`)
	function writeNumberCols(genderSymbol,genderTitle) {
		for (const [number,numberTitle] of [
			[1,`единственное число`],
			[2,`множественное число`],
		]) {
			const $cell=document.createElement('th')
			const $genderAndNumber=document.createElement('span')
			$genderAndNumber.innerText=genderSymbol.repeat(number)
			$genderAndNumber.title=`${genderTitle}, ${numberTitle}`
			$cell.append($genderAndNumber)
			$row.append($cell)
		}
	}
}

function writeUsual($table) {
	writeExplanation($table,`обычные окончания и изменения по родам/числам`)
	writeWordQuartetRow($table,"ragazz","o","i","a","e")
	writeWordPairsRow($table,"libr","cas","o","i","a","e")
	writeWordQuartetRow($table,"nipot","e","i","e","i")
	writeWordPairsRow($table,"can","chiav","e","i","e","i")
}

function writeExplanation($table,text) {
	const $row=$table.insertRow()
	const $cell=$row.insertCell()
	$cell.colSpan=4
	$cell.innerText=text
}

function writeWordQuartetRow($table,wordStem,wordEndingM,wordEndingMM,wordEndingF,wordEndingFF) {
	const $row=$table.insertRow()
	writeWordQuartet($row,wordStem,wordEndingM,wordEndingMM,wordEndingF,wordEndingFF)
}

function writeWordPairsRow($table,wordStemM,wordStemF,wordEndingM,wordEndingMM,wordEndingF,wordEndingFF) {
	const $row=$table.insertRow()
	writeWordPair($row,'m',wordStemM,wordEndingM,wordEndingMM)
	writeGap($row)
	writeWordPair($row,'f',wordStemF,wordEndingF,wordEndingFF)
}

function writeWordQuartet($row,wordStem,wordEndingM,wordEndingMM,wordEndingF,wordEndingFF) {
	writeWordPair($row,'m',wordStem,wordEndingM,wordEndingMM)
	const $cell=$row.insertCell()
	$cell.innerText="⟷"
	writeWordPair($row,'f',wordStem,wordEndingF,wordEndingFF)
}

function writeWordPair($row,gender,wordStem,wordEndingSingular,wordEndingPlural) {
	writeWord($row,gender,1,wordStem,wordEndingSingular)
	writeWord($row,gender,2,wordStem,wordEndingPlural)
}

function writeWord($row,gender,number,wordStem,wordEnding) {
	const word=wordStem+wordEnding
	const $cell=$row.insertCell()
	if (articlesSetting==true) {
		$cell.append(getArticle(gender,number,word)+" ")
	}
	const $word=document.createElement('a')
	$word.href=`https://it.wiktionary.org/wiki/${word}`
	const $stem=document.createElement('span')
	$stem.classList.add('stem')
	$stem.innerText=wordStem
	const $ending=document.createElement('span')
	$ending.classList.add('ending')
	$ending.innerText=wordEnding
	$word.append($stem,$ending)
	$cell.append($word)
}

function writeGap($row) {
	const $cell=$row.insertCell()
}

function getArticle(gender,number,word) {
	if (gender=='m') {
		if (number==1) {
			return "il"
		} else {
			return "i"
		}
	} else {
		if (number==1) {
			return "la"
		} else {
			return "le"
		}
	}
}
</script>
</body>
</html>
